<html>

<head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"></head>
    <body>





<form class="needs-validation" novalidate>
<div class="row justify-content-center">
<div class="col-8">
    <h2>Форма с валидацией</h2>
  <div class="form-row">
    <div class="col-md-4 mb-3">
      <label for="validationCustom01">Фамилия</label>
      <input type="text" class="form-control" id="last_name" placeholder="Фамилия" required>
      <div class="valid-feedback">
        Looks good!
      </div>
        <div class="invalid-feedback">
          Заполни фамилию, пожалуйста.
        </div>
      <label for="validationCustom02">Имя</label>
      <input type="text" class="form-control" id="first_name" placeholder="Имя"  required>
      <div class="valid-feedback">
        Looks good!
      </div>
        <div class="invalid-feedback">
          Заполни имя, пожалуйста.
        </div>
      <label for="validationCustom02">Отчество</label>
      <input type="text" class="form-control" id="Patronymic" placeholder="Отчество" >
      <div class="valid-feedback">
        Looks good!
      </div>      
    </div>
    <div class="col-md-6 mb-3">
        <div class="form-row">
        <div class="col-md-4 mb-3">
          <label for="validationCustom03">Серия</label>
          <input type="text" class="form-control" id="Series" placeholder="Серия" required>
          <div class="invalid-feedback">
            Не заполнен номер паспорта
          </div>
        </div>
        <div class="col-md-8 mb-3">
          <label for="validationCustom04">Номер</label>
          <input type="text" class="form-control" id="Number" placeholder="Номер" required>
          <div class="invalid-feedback">
            Please provide a valid state.
          </div>
        </div>

      </div>
        <div class="form-row">
          <label for="validationCustom04">Дата выдачи</label>
          <input type="textarea" class="form-control" id="IssueDate" placeholder="Дата выдачи" required>
          <div class="invalid-feedback">
            Please provide a valid state.
          </div>
      </div>
              <div class="form-row">
          <label for="validationCustom04">Кем выдан</label>
          <input type="textarea" class="form-control" id="IssuedBy" placeholder="Кем выдан" required>
          <div class="invalid-feedback">
            Please provide a valid state.
          </div>
      </div>
              <div class="form-row">
          <label for="validationCustom04">Адрес</label>
          <input type="textarea" class="form-control" id="Address" placeholder="Адрес" required>
          <div class="invalid-feedback">
            Please provide a valid state.
          </div>
      </div>
    </div>

  </div>
  <div class="form-row">
    <div class="col-md-6 mb-3">
      <label for="validationCustom03">Телефон</label>
      <input type="text" class="form-control" id="PhoneNumber" placeholder="Телефон" required>
      <div class="invalid-feedback">
        Please provide a valid city.
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <label for="validationCustom04">Электронная почта</label>
      <input type="text" class="form-control" id="email" placeholder="email" required>
      <div class="invalid-feedback">
        Please provide a valid state.
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <label for="validationCustom05">СНИЛС</label>
      <input type="text" class="form-control" id="snils" placeholder="СНИЛС" required>
      <div class="invalid-feedback">
        Please provide a valid zip.
      </div>
    </div>
  </div>
 <!-- <div class="form-group">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" value="" id="invalidCheck" required>
      <label class="form-check-label" for="invalidCheck">
        Agree to terms and conditions
      </label>
      <div class="invalid-feedback">
        You must agree before submitting.
      </div>
    </div>
  </div> -->
  <button onclick="generate()" class="btn btn-primary" type="submit">Submit form</button>
</div>
</div>
</form>
<button onclick="generate()" class="btn btn-primary" type="submit">Submit form</button>





    </body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.17.6/docxtemplater.js"></script>
    <script src="https://unpkg.com/pizzip@3.0.6/dist/pizzip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
    <script src="https://unpkg.com/pizzip@3.0.6/dist/pizzip-utils.js"></script>
    <!--
    Mandatory in IE 6, 7, 8 and 9.
    -->
    <!--[if IE]>
        <script type="text/javascript" src="https://unpkg.com/pizzip@3.0.6/dist/pizzip-utils-ie.js"></script>
    <![endif]-->
    <script>



// Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';
  window.addEventListener('load', function() {
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();



    function loadFile(url,callback){
        PizZipUtils.getBinaryContent(url,callback);
    }
    function generate() {
        loadFile('worddoc.docx',function(error,content){
            if (error) { throw error };

            // The error object contains additional information when logged with JSON.stringify (it contains a properties object containing all suberrors).
            function replaceErrors(key, value) {
                if (value instanceof Error) {
                    return Object.getOwnPropertyNames(value).reduce(function(error, key) {
                        error[key] = value[key];
                        return error;
                    }, {});
                }
                return value;
            }

            function errorHandler(error) {
                console.log(JSON.stringify({error: error}, replaceErrors));

                if (error.properties && error.properties.errors instanceof Array) {
                    const errorMessages = error.properties.errors.map(function (error) {
                        return error.properties.explanation;
                    }).join("\n");
                    console.log('errorMessages', errorMessages);
                    // errorMessages is a humanly readable message looking like this :
                    // 'The tag beginning with "foobar" is unopened'
                }
                throw error;
            }

            var zip = new PizZip(content);
            var doc;
            try {
                doc=new window.docxtemplater(zip);
            } catch(error) {
                // Catch compilation errors (errors caused by the compilation of the template : misplaced tags)
                errorHandler(error);
            }


            doc.setData({
                    LastName: document.getElementById('last_name').value,
                    FirstName: document.getElementById('first_name').value,
                    Patronymic: document.getElementById('Patronymic').value,
                    Series: document.getElementById('Series').value,
                    Number: document.getElementById('Number').value,
                    IssueDate: document.getElementById('IssueDate').value,
                    IssuedBy: document.getElementById('IssuedBy').value,
                    Address: document.getElementById('Address').value,
                    PhoneNumber: document.getElementById('PhoneNumber').value,
                    email: document.getElementById('email').value,
                    snils: document.getElementById('snils').value
                });
            try {
                // render the document (replace all occurences of {first_name} by John, {last_name} by Doe, ...)
                doc.render();
            }
            catch (error) {
                // Catch rendering errors (errors relating to the rendering of the template : angularParser throws an error)
                errorHandler(error);
            }

            var out=doc.getZip().generate({
                type:"blob",
                mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
            }) //Output the document using Data-URI
            saveAs(out,"output.docx")
        })
    }


    </script>



</html>